import DrawObject from '../src/object/DrawObject'

interface LeafOption {
  speed? : number,
  speedDown? : number,
  lineWidth? : number,
  alpha? : number,
  random? :boolean
}

export default class Leaf extends DrawObject {
  private radius : number = 100
  private alphaMax : number = 1
  private alpha : number = 12
  private endPoint : DOMPoint

  private speed : number = 5
  private speedDown : number = 5
  private lineWidth : number = 10
  private randomOn :boolean = true

  constructor (point: Array<number>)
  constructor (point: Array<number>, op : LeafOption)
  constructor (point: Array<number>, op? : LeafOption) {
    super(point)
    const init :LeafOption = op || {}
    const rand : boolean = typeof init.random === 'undefined' ? this.randomOn : init.random
    if (rand) {
      this.speed = Math.floor(Math.random() * (init.speed || this.speed)) + 1
      this.speedDown = Math.floor(Math.random() * (init.speedDown || this.speedDown)) + 2
      this.lineWidth = Math.floor((Math.random() * (init.lineWidth || this.lineWidth))) + 1
      this.alpha = init.alpha ? Math.floor((Math.random() * (init.alpha))) + 10 : this.alpha
    } else {
      this.speed = init.speed || this.speed
      this.speedDown = init.speedDown || this.speedDown
      this.lineWidth = init.lineWidth || this.lineWidth
      this.alpha = init.alpha || this.alpha
    }
  }

  public created (): void {}

  public paint (ctx: CanvasRenderingContext2D, positionX :number, positionY:number): void {
    const x = positionX
    const y = positionY
    ctx.beginPath()
    ctx.arc(x, y, this.radius, 0, 2 * Math.PI, false)
    ctx.lineWidth = this.lineWidth
    ctx.strokeStyle = 'rgba(' + this.color + ',' + this.alphaMax + ')'
    ctx.stroke()
  }

  private counter : number = 0
  private points : Array<number> = [0, 0]
  private slow : boolean = false
  public move (): void {
    const svg :string = '<svg width="480.00" height="600.00" viewBox="0.00 0.00 4000.00 5000.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke-linecap="round">'
    + '<path id="svgPath" d="M1190.02,284.07 C1190.02,284.07 1190.50,277.51 1190.50,277.51 C1193.35,280.73 1203.94,301.06 1212.08,313.62 C1216.68,320.57 1226.25,331.68 1232.93,338.27 C1238.55,343.61 1250.92,354.55 1257.14,359.93 C1265.56,366.90 1274.90,373.89 1280.73,378.03 C1292.07,385.71 1314.36,398.51 1332.50,407.89 C1347.00,415.04 1376.92,429.32 1392.77,436.30 C1406.56,441.87 1434.96,452.89 1449.57,458.34 C1465.26,463.72 1497.51,474.41 1511.71,478.73 C1526.62,483.05 1557.26,491.66 1572.99,495.95 C1588.35,499.88 1619.06,507.43 1634.42,511.04 C1668.07,518.04 1727.91,528.92 1755.62,533.83 C1767.95,535.81 1798.75,540.08 1817.21,542.39 C1844.08,545.09 1905.05,550.85 1939.16,553.91 C1956.14,555.12 1989.52,557.25 2005.93,558.16 C2021.90,558.79 2053.74,559.83 2069.61,560.24 C2101.09,560.50 2164.11,560.43 2195.64,560.11 C2227.77,559.16 2291.88,556.71 2323.85,555.22 C2356.56,553.06 2422.85,548.07 2456.44,545.23 C2485.77,542.44 2546.73,536.00 2578.36,532.36 C2608.03,528.22 2669.91,518.98 2702.10,513.90 C2718.16,511.20 2749.57,505.76 2764.91,503.01 C2780.80,499.89 2811.06,493.69 2825.42,490.60 C2840.46,487.09 2872.91,479.17 2890.30,474.78 C2906.47,470.53 2937.93,462.36 2942.03,462.04 C2936.14,468.23 2927.54,474.15 2925.69,475.42 C2897.97,494.08 2849.81,528.63 2823.96,547.41 C2798.81,565.91 2743.41,606.79 2713.16,629.16 C2684.56,650.30 2632.44,688.76 2608.91,706.08 C2595.63,715.78 2564.08,738.65 2545.80,751.81 C2529.88,763.00 2483.14,793.85 2460.58,808.58 C2447.21,817.17 2419.47,834.79 2405.11,843.80 C2390.52,852.57 2361.93,869.29 2347.93,877.24 C2319.51,892.69 2262.16,922.22 2234.66,935.60 C2218.71,942.92 2187.78,956.70 2172.81,963.16 C2159.29,968.81 2131.42,980.24 2117.07,986.01 C2102.66,991.52 2074.28,1002.15 2060.31,1007.27 C2045.76,1012.30 2015.93,1022.47 2000.64,1027.60 C1970.50,1037.19 1909.67,1055.13 1879.19,1063.37 C1863.80,1067.32 1833.08,1074.95 1817.74,1078.63 C1802.06,1082.13 1771.34,1088.84 1756.31,1092.04 C1741.74,1094.91 1711.98,1100.54 1696.80,1103.32 C1667.09,1108.14 1605.22,1117.69 1570.77,1122.12 C1555.26,1123.81 1523.63,1127.04 1507.51,1128.58 C1475.46,1131.21 1414.43,1135.65 1385.45,1137.45'
    + 'C1359.09,1138.49 1289.76,1139.47 1255.81,1139.72 C1218.06,1139.76 1148.03,1139.81 1115.73,1139.84 C1094.58,1139.90 1084.21,1140.20 1081.26,1141.45 C1079.93,1142.02 1077.87,1143.48 1076.81,1144.44 C1078.39,1147.41 1080.74,1149.59 1084.55,1151.95 C1099.25,1160.57 1114.03,1167.68 1134.02,1176.67 C1163.77,1189.85 1226.60,1217.45 1259.68,1231.87 C1273.71,1237.87 1304.39,1250.80 1321.03,1257.73 C1335.88,1263.65 1363.22,1274.26 1375.70,1278.94 C1404.23,1289.09 1461.95,1309.15 1491.14,1319.06 C1523.28,1329.63 1586.34,1349.80 1617.28,1359.42 C1647.64,1368.24 1708.57,1385.46 1739.13,1393.86 C1769.48,1401.67 1830.86,1417.02 1861.89,1424.54 C1877.66,1428.19 1909.23,1435.36 1925.02,1438.87 C1955.98,1445.26 2018.16,1457.50 2049.37,1463.35 C2080.68,1468.70 2143.33,1478.79 2174.67,1483.53 C2206.58,1487.71 2270.09,1495.47 2301.68,1499.05 C2317.07,1500.58 2348.42,1503.47 2364.38,1504.83 C2396.19,1507.02 2459.79,1510.78 2491.60,1512.35 C2523.78,1513.27 2589.07,1514.55 2622.17,1514.91 C2653.21,1514.89 2716.99,1514.39 2749.73,1513.90 C2779.79,1512.95 2840.71,1510.57 2871.58,1509.15 C2901.23,1507.50 2979.92,1503.15 2993.42,1503.13 C3003.26,1503.29 3014.82,1504.58 3025.38,1506.87 C3026.63,1507.14 3028.86,1507.61 3029.83,1507.82 C3030.13,1510.56 3031.02,1517.05 3030.41,1519.83 C3029.64,1523.20 3025.80,1528.99 3024.46,1530.69 C3020.72,1535.42 2993.54,1562.07 2985.79,1569.34 C2964.63,1588.96 2917.25,1632.49 2891.03,1656.39 C2864.71,1679.79 2813.46,1724.87 2788.54,1746.54 C2762.65,1768.71 2713.35,1810.65 2689.94,1830.43 C2678.80,1839.71 2653.50,1860.57 2639.33,1872.16 C2615.31,1891.17 2567.60,1928.17 2543.92,1946.16 C2519.98,1963.70 2470.07,1999.68 2444.11,2018.13 C2430.50,2027.38 2402.99,2045.74 2389.09,2054.86 C2375.06,2063.72 2346.44,2081.53 2331.85,2090.49 C2303.16,2107.54 2247.59,2139.99 2220.71,2155.38 C2204.87,2163.94 2179.99,2176.53 2167.85,2182.56 C2140.04,2195.82 2082.33,2222.85 2053.11,2235.58 C2038.34,2241.73 2008.89,2253.78 1994.21,2259.67 C1979.57,2265.24 1950.13,2276.21 1935.33,2281.60 C1920.72,2286.71 1890.92,2296.79 1875.72,2301.78 C1860.48,2306.53 1830.07,2315.73 1814.90,2320.18 C1798.95,2324.46 1767.70,2332.66 1752.41,2336.58'
    +'C1738.36,2340.02 1710.76,2346.52 1697.21,2349.59 C1679.90,2352.96 1647.78,2358.47 1634.11,2360.70 C1618.02,2363.17 1584.77,2368.08 1567.62,2370.53 C1551.55,2372.52 1519.54,2376.22 1502.03,2377.84 C1485.24,2379.13 1453.98,2380.72 1438.80,2381.34 C1424.54,2381.70 1393.60,2382.15 1376.92,2382.24 C1361.11,2382.01 1331.33,2381.51 1317.38,2381.24 C1300.17,2380.82 1263.39,2380.16 1256.49,2381.08 C1253.29,2381.52 1246.46,2383.42 1244.12,2384.07 C1249.67,2386.05 1263.62,2390.90 1271.09,2392.50 C1300.34,2398.36 1363.12,2410.48 1396.64,2416.74 C1427.39,2422.10 1487.98,2432.38 1517.82,2437.28 C1547.58,2441.81 1609.18,2450.65 1641.02,2454.96 C1671.71,2458.63 1735.38,2465.75 1768.36,2469.21 C1784.66,2470.65 1816.66,2473.29 1832.36,2474.49 C1864.37,2476.47 1928.46,2479.89 1960.55,2481.32 C1992.44,2482.11 2056.55,2483.17 2088.78,2483.44 C2118.88,2483.44 2178.65,2483.16 2208.32,2482.87 C2238.05,2482.27 2302.47,2480.51 2337.16,2479.34 C2369.11,2478.05 2437.12,2475.18 2473.17,2473.61 C2504.09,2472.44 2576.92,2469.99 2608.05,2469.89 C2619.34,2470.08 2652.49,2471.91 2657.32,2472.73 C2661.30,2473.41 2669.59,2476.13 2671.32,2477.08 C2673.67,2478.39 2679.12,2483.46 2679.88,2485.57 C2680.60,2487.72 2679.54,2494.47 2678.03,2497.57 C2675.94,2501.72 2665.80,2513.78 2659.93,2519.42 C2650.98,2527.76 2624.21,2548.20 2614.66,2554.90 C2602.08,2563.41 2575.35,2579.97 2563.03,2587.45 C2548.86,2595.66 2519.58,2612.13 2504.48,2620.39 C2477.25,2634.44 2420.21,2662.30 2392.41,2675.63 C2378.26,2682.09 2351.00,2694.31 2337.90,2700.06 C2310.14,2711.66 2252.12,2734.39 2224.31,2745.02 C2208.65,2750.84 2177.42,2762.27 2161.86,2767.87 C2131.17,2778.51 2071.36,2797.71 2041.44,2807.03 C2026.42,2811.45 1996.32,2820.14 1981.23,2824.41 C1949.72,2832.70 1887.02,2848.60 1855.85,2856.21 C1842.13,2859.44 1812.48,2866.19 1796.55,2869.73 C1766.74,2875.90 1706.39,2886.94 1676.59,2891.73 C1643.44,2896.75 1579.39,2905.94 1548.50,2910.12 C1534.07,2911.81 1504.74,2914.94 1489.84,2916.37 C1454.52,2918.99 1386.23,2922.66 1349.90,2924.43 C1342.37,2924.80 1328.43,2925.49 1322.03,2925.81 C1316.76,2926.10 1306.98,2926.59 1300.04,2928.16 C1300.04,2928.16 1299.94,2930.73 1299.94,2930.73'
    +'C1318.49,2937.18 1327.94,2939.69 1347.51,2944.22 C1375.87,2950.65 1439.73,2964.86 1475.23,2972.65 C1492.28,2976.22 1525.75,2983.10 1542.16,2986.42 C1559.26,2989.68 1592.99,2995.95 1609.62,2998.95 C1640.99,3004.10 1701.84,3013.65 1731.33,3018.06 C1762.22,3022.20 1824.27,3029.97 1855.43,3033.59 C1870.99,3035.18 1902.40,3038.25 1918.26,3039.73 C1949.05,3042.11 2011.74,3046.48 2043.66,3048.46 C2076.02,3050.06 2140.18,3052.73 2171.97,3053.81 C2203.95,3054.46 2267.69,3055.43 2299.46,3055.77 C2331.20,3055.79 2395.30,3055.51 2427.65,3055.21 C2459.30,3054.64 2522.72,3053.18 2554.51,3052.28 C2587.20,3051.01 2649.80,3048.33 2679.70,3046.93 C2711.83,3045.11 2773.58,3041.46 2803.21,3039.63 C2819.07,3038.79 2851.70,3037.20 2868.47,3036.45 C2883.69,3035.96 2916.66,3035.20 2930.93,3035.52 C2938.56,3035.80 2953.16,3037.38 2958.72,3038.17 C2961.93,3038.64 2969.80,3040.77 2972.93,3042.25 C2976.62,3044.07 2980.09,3047.20 2981.99,3050.54 C2982.81,3052.06 2983.89,3055.35 2983.99,3056.80 C2984.09,3058.90 2982.28,3065.76 2980.73,3069.72 C2978.82,3074.55 2970.75,3086.96 2964.79,3094.21 C2961.80,3097.84 2939.53,3121.79 2923.80,3136.97 C2903.60,3155.46 2853.45,3199.28 2829.95,3218.96 C2805.83,3238.58 2756.18,3278.39 2730.65,3298.58 C2706.39,3317.21 2656.26,3355.24 2630.38,3374.64 C2604.99,3393.01 2554.21,3429.18 2528.82,3446.98 C2515.54,3456.04 2488.48,3474.28 2474.71,3483.46 C2446.77,3501.43 2389.45,3537.56 2360.06,3555.73 C2333.19,3571.94 2284.08,3601.34 2249.78,3620.96 C2233.35,3629.96 2173.89,3660.43 2146.69,3674.11 C2132.03,3681.28 2103.01,3695.21 2088.64,3701.97 C2074.18,3708.51 2045.12,3721.46 2030.53,3727.86 C2016.03,3734.01 1986.88,3746.10 1972.23,3752.05 C1957.41,3757.87 1927.93,3769.23 1913.27,3774.78 C1898.60,3780.05 1869.11,3790.43 1854.29,3795.54 C1839.59,3800.41 1809.86,3809.98 1794.82,3814.68 C1779.48,3819.23 1748.94,3828.06 1733.73,3832.34 C1703.75,3840.21 1643.76,3854.42 1613.83,3860.78 C1598.55,3863.76 1568.14,3869.46 1553.01,3872.19 C1522.68,3877.09 1461.55,3885.39 1431.70,3888.71 C1416.74,3890.08 1384.99,3892.64 1368.20,3893.82 C1354.12,3894.48 1324.27,3895.71 1308.50,3896.28 C1292.04,3896.62 1259.69,3896.97 1243.81,3896.98 '
    +'C1228.95,3896.70 1198.90,3895.89 1183.69,3895.36 C1167.72,3894.41 1135.16,3892.04 1118.57,3890.63 C1101.91,3888.82 1067.69,3884.77 1050.13,3882.53 C1033.88,3880.27 1004.41,3876.02 991.19,3874.03 C981.01,3872.26 959.00,3868.14 954.61,3867.05 C938.72,3862.92 928.39,3858.92 918.44,3854.25 C928.30,3853.72 935.22,3853.98 942.66,3854.87 C970.61,3858.82 1032.85,3867.49 1067.14,3872.22 C1098.86,3876.48 1165.06,3885.31 1199.55,3889.87 C1230.42,3893.86 1295.14,3902.00 1328.98,3906.15 C1358.46,3909.50 1418.37,3916.07 1448.80,3919.29 C1478.82,3922.23 1541.00,3928.12 1573.16,3931.08 C1605.68,3933.79 1668.84,3938.68 1699.48,3940.87 C1731.17,3942.88 1794.94,3946.61 1827.03,3948.33 C1858.59,3949.65 1921.60,3951.91 1953.06,3952.86 C1985.03,3953.51 2048.76,3954.43 2080.51,3954.71 C2112.13,3954.54 2175.64,3953.82 2207.52,3953.26 C2239.28,3952.37 2302.00,3950.34 2332.96,3949.20 C2365.59,3947.58 2430.61,3944.03 2462.99,3942.10 C2493.82,3940.08 2555.13,3935.83 2585.62,3933.61 C2615.74,3931.19 2676.94,3925.95 2708.02,3923.13 C2741.26,3919.71 2808.89,3912.44 2843.27,3908.60 C2878.20,3904.53 2938.60,3897.46 2964.06,3894.45 C2992.82,3890.68 3065.47,3880.95 3085.46,3879.23 C3094.67,3878.64 3113.78,3878.04 3115.06,3878.49 C3116.65,3879.05 3118.97,3880.91 3120.07,3882.26 C3118.41,3886.49 3117.03,3889.13 3114.71,3891.48 C3107.61,3898.79 3082.81,3920.46 3073.77,3928.21 C3051.78,3946.80 3002.38,3988.65 2974.96,4011.91 C2947.72,4035.40 2895.09,4081.06 2869.71,4103.23 C2843.94,4125.96 2795.79,4168.41 2773.40,4188.12 C2748.19,4210.07 2701.32,4250.38 2679.65,4268.74 C2656.60,4287.45 2607.68,4326.47 2581.80,4346.78 C2569.06,4356.52 2543.60,4375.76 2530.88,4385.25 C2502.64,4405.56 2451.06,4440.78 2425.93,4457.63 C2413.09,4465.80 2387.52,4481.80 2374.79,4489.63 C2361.38,4497.59 2333.97,4513.64 2319.98,4521.74 C2292.07,4537.12 2236.29,4566.15 2209.69,4579.19 C2195.44,4585.87 2167.42,4598.67 2153.66,4604.79 C2140.03,4610.65 2111.29,4622.76 2096.18,4629.02 C2080.00,4635.32 2049.49,4646.85 2035.16,4652.07 C2019.93,4657.38 1989.13,4667.89 1973.56,4673.10 C1958.73,4677.87 1928.38,4687.37 1912.86,4692.10 C1881.73,4700.98 1824.35,4715.94 1792.54,4723.33 C1777.14,4726.59 1747.52,4732.66 1733.30,4735.46 C1716.91,4738.29 1685.37,4743.41 1670.20,4745.69 C1655.50,4747.57 1623.81,4750.55 1610.59,4751.35 C1589.77,4751.98 1576.52,4751.04 1569.78,4750.00" fill="none" stroke="rgb(44, 37, 39)" stroke-width="170.00" stroke-opacity="1.00" stroke-linejoin="round"/>'
    +'</g></svg>'

    const el = new DOMParser().parseFromString(svg, 'image/svg+xml').getElementById('svgPath') as Element
    const svgE = el as SVGElement
    const svgG = svgE as SVGGeometryElement
    const length = svgG.getTotalLength()
    this.endPoint = svgG.getPointAtLength(length)
    if (this.slow) {
      this.counter += 0.5
    } else {
      this.counter++
    }
    const point : DOMPoint = svgG.getPointAtLength(length / 1000 * this.counter)
    if (point.x > 2500 || point.x < 1500) {
      this.slow = true
    } else {
      this.slow = false
    }
    console.log(point.x, point.y)
    if (this.points[0] === 0) {
      this.points = [point.x, point.y]
    }
    this.x = (point.x - this.points[0]) / 5
    this.y = (point.y - this.points[1]) / 5

    if (this.endPoint.x === point.x) {
      this.kill()
    }
  }

  public destroy (): boolean {
    if (this.counter > 1000) {
      return true
    }
    return false
  }

  public event () : void {}
}
